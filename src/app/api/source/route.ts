import { NextResponse } from 'next/server';

// You should store this in .env.local
const PDL_API_KEY = process.env.PDL_API_KEY;
const PDL_BASE_URL = 'https://api.peopledatalabs.com/v5';

async function searchPerson(linkedinUrl: string){
  try {
    // const params = new URLSearchParams({
    //   profile: linkedinUrl,
    //   pretty: 'true',
    //   titlecase: 'true'
    // });

    // const response = await fetch(`${PDL_BASE_URL}/person/enrich?${params.toString()}`, {
    //   method: 'GET',
    //   headers: {
    //     'X-Api-Key': PDL_API_KEY || '',
    //   },
    // });

    // if (!response.ok) {
    //   console.error('PDL API Error:', response.status, response.statusText);
    //   throw new Error(`PDL API Error: ${response.status} ${response.statusText}`);
    // }

    // const apiResponse = await response.json();

    // Transform PDL data to match our frontend expectations
    // const personData = apiResponse.data;
    const personData={
        "id": "NvnAvOpyEVAoNGnVZQUqLU_0000",
        "full_name": "sarah richard",
        "first_name": "sarah",
        "middle_initial": null,
        "middle_name": null,
        "last_initial": "r",
        "last_name": "richard",
        "sex": "female",
        "birth_year": 1987,
        "birth_date": "1987-06-07",
        "linkedin_url": "linkedin.com/in/sr49",
        "linkedin_username": "sr49",
        "linkedin_id": "NvnAvO",
        "headline": null,
        "facebook_url": "facebook.com/sr49",
        "facebook_username": "sr49",
        "facebook_id": "NvnAvO",
        "twitter_url": "twitter.com/sr49",
        "twitter_username": "sr49",
        "github_url": "github.com/sr49",
        "github_username": "sr49",
        "personal_emails": [
          "sr49@icloud.com",
          "sr49@icloud.com",
          "sr49@icloud.com"
        ],
        "recommended_personal_email": "sr49@icloud.com",
        "mobile_phone": "+18097463343",
        "industry": "online media",
        "job_title": "musician",
        "job_title_role": "creative",
        "job_title_sub_role": "entertainment",
        "job_title_class": "services",
        "job_title_levels": [
          "senior",
          "senior"
        ],
        "job_onet_code": null,
        "job_onet_major_group": null,
        "job_onet_minor_group": null,
        "job_onet_broad_occupation": null,
        "job_onet_specific_occupation": null,
        "job_onet_specific_occupation_detail": null,
        "job_company_id": "nbxFAEZEzhksXZ6ZWUJLkxUeADg9",
        "job_company_name": "chang-fisher",
        "job_company_website": "chang-fisher.com",
        "job_company_size": "10001+",
        "job_company_founded": 2008,
        "job_company_industry": "online media",
        "job_company_linkedin_url": "linkedin.com/company/chang-fisher",
        "job_company_linkedin_id": "51706749",
        "job_company_facebook_url": "facebook.com/chang-fisher",
        "job_company_twitter_url": "twitter.com/chang-fisher",
        "job_company_type": "private",
        "job_company_ticker": null,
        "job_company_location_name": "changchester, ontario, canada",
        "job_company_location_locality": "changchester",
        "job_company_location_metro": "changchester",
        "job_company_location_region": "ontario",
        "job_company_location_geo": "13.4134995,26.826999",
        "job_company_location_street_address": "0487 hull village suite 759",
        "job_company_location_address_line_2": "suite 604",
        "job_company_location_postal_code": "A6A 6A0",
        "job_company_location_country": "canada",
        "job_company_location_continent": "north america",
        "job_company_employee_count": 50495,
        "job_company_inferred_revenue": "$250M-$500M",
        "job_company_12mo_employee_growth_rate": null,
        "job_company_total_funding_raised": null,
        "job_last_changed": "2019-11-24",
        "job_last_verified": "2020-06-13",
        "job_start_date": "2019-11-24",
        "job_summary": "musician at chang-fisher",
        "location_name": "changchester, ontario, canada",
        "location_locality": "changchester",
        "location_metro": "changchester",
        "location_region": "ontario",
        "location_country": "canada",
        "location_continent": "north america",
        "location_street_address": "0487 hull village suite 759",
        "location_address_line_2": "suite 604",
        "location_postal_code": "A6A 6A0",
        "location_geo": "13.4134995,26.826999",
        "location_last_updated": "2021-09-09",
        "linkedin_connections": 6311,
        "facebook_friends": 6311,
        "inferred_salary": "70,000-85,000",
        "inferred_years_experience": 2,
        "summary": "musician at chang-fisher",
        "phone_numbers": [
          "+16399577766",
          "+18079521829",
          "+16041271942"
        ],
        "phones": [
          {
            "number": "+16399577766",
            "first_seen": "2019-06-07",
            "last_seen": "2019-10-22",
            "num_sources": 8
          },
          {
            "number": "+18079521829",
            "first_seen": "2019-07-10",
            "last_seen": "2019-03-23",
            "num_sources": 8
          },
          {
            "number": "+16041271942",
            "first_seen": "2019-04-16",
            "last_seen": "2019-04-11",
            "num_sources": 10
          }
        ],
        "emails": [
          {
            "address": "katherine_fisher_2012@outlook.com",
            "type": "personal",
            "first_seen": "2025-02-21T16:57:47",
            "last_seen": "2025-03-08T07:35:47",
            "num_sources": 9
          },
          {
            "address": "m_nielsen_1986@yahoo.com",
            "type": "disposable",
            "first_seen": "2025-01-04T04:49:52",
            "last_seen": "2025-03-04T16:41:45",
            "num_sources": 10
          },
          {
            "address": "cynthiaz@me.com",
            "type": "current_professional",
            "first_seen": "2025-01-04T12:47:58",
            "last_seen": "2025-03-04T07:43:35",
            "num_sources": 6
          }
        ],
        "interests": [],
        "skills": [
          "science",
          "coach"
        ],
        "location_names": [
          "west tammyfort, ontario, canada",
          "cherylborough, ontario, canada",
          "davismouth, quebec, canada"
        ],
        "regions": [
          "ontario",
          "ontario",
          "quebec"
        ],
        "countries": [
          "united states",
          "canada"
        ],
        "street_addresses": [
          {
            "name": "west tammyfort, ontario, canada",
            "locality": "west tammyfort",
            "region": "ontario",
            "metro": "west tammyfort",
            "country": "canada",
            "continent": "north america",
            "street_address": "7593 juan throughway apt. 948",
            "address_line_2": "apt. 411",
            "postal_code": "A5A 7A8",
            "geo": "-62.968225,9.940272",
            "first_seen": "2019-05-03",
            "last_seen": "2021-09-07",
            "num_sources": 3
          },
          {
            "name": "thomasland, california, united states",
            "locality": "thomasland",
            "region": "california",
            "metro": "thomasland",
            "country": "united states",
            "continent": "north america",
            "street_address": "01868 boyd freeway",
            "address_line_2": "apt. 969",
            "postal_code": "36573",
            "geo": "30.947112,84.492344",
            "first_seen": "2019-09-07",
            "last_seen": "2020-03-22",
            "num_sources": 3
          },
          {
            "name": "williamsville, california, united states",
            "locality": "williamsville",
            "region": "california",
            "metro": "williamsville",
            "country": "united states",
            "continent": "north america",
            "street_address": "45792 tammy centers apt. 258",
            "address_line_2": "suite 197",
            "postal_code": "87743",
            "geo": "-43.0722505,-172.911287",
            "first_seen": "2019-09-22",
            "last_seen": "2021-11-20",
            "num_sources": 10
          }
        ],
        "experience": [
          {
            "company": {
              "name": "chang-fisher",
              "size": "10001+",
              "id": "nbxFAEZEzhksXZ6ZWUJLkxUeADg9",
              "founded": 2008,
              "industry": "online media",
              "location": {
                "name": "changchester, ontario, canada",
                "locality": "changchester",
                "region": "ontario",
                "metro": "changchester",
                "country": "canada",
                "continent": "north america",
                "street_address": "0487 hull village suite 759",
                "address_line_2": "suite 604",
                "postal_code": "A6A 6A0",
                "geo": "13.4134995,26.826999"
              },
              "linkedin_url": "linkedin.com/company/chang-fisher",
              "linkedin_id": "51706749",
              "facebook_url": "facebook.com/chang-fisher",
              "twitter_url": "twitter.com/chang-fisher",
              "website": "chang-fisher.com",
              "ticker": null,
              "type": "private",
              "raw": [
                "chang-fisher"
              ],
              "fuzzy_match": false
            },
            "location_names": [
              "changchester, ontario, canada"
            ],
            "end_date": "2021-09-09",
            "start_date": "2019-11-24",
            "title": {
              "name": "musician",
              "raw": [
                "musician"
              ],
              "class": null,
              "role": "creative",
              "sub_role": "entertainment",
              "levels": [
                "senior",
                "senior"
              ]
            },
            "is_primary": true,
            "summary": "musician at chang-fisher",
            "num_sources": 7,
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09"
          },
          {
            "company": {
              "name": "williams-sheppard",
              "size": "10001+",
              "id": "lgF7JnA6OfmB1nv7zFXcNDV7l1nJ",
              "founded": 2017,
              "industry": "logistics and supply chain",
              "location": {
                "name": "brandyborough, ontario, canada",
                "locality": "brandyborough",
                "region": "ontario",
                "metro": "brandyborough",
                "country": "canada",
                "continent": "north america",
                "street_address": "2194 kyle stream",
                "address_line_2": "apt. 578",
                "postal_code": "A1A 5A6",
                "geo": "-5.121595,147.967447"
              },
              "linkedin_url": "linkedin.com/company/williams-sheppard",
              "linkedin_id": "85956173",
              "facebook_url": "facebook.com/williams-sheppard",
              "twitter_url": "twitter.com/williams-sheppard",
              "website": "williams-sheppard.com",
              "ticker": null,
              "type": "public",
              "raw": [
                "williams-sheppard"
              ],
              "fuzzy_match": false
            },
            "location_names": [
              "pagetown, california, united states"
            ],
            "end_date": "2020-09-23",
            "start_date": "2019-11-13",
            "title": {
              "name": "sub",
              "raw": [
                "sub"
              ],
              "class": null,
              "role": null,
              "sub_role": null,
              "levels": [
                "unpaid"
              ]
            },
            "is_primary": false,
            "summary": "sub at williams-sheppard",
            "num_sources": 1,
            "first_seen": "2018-05-10",
            "last_seen": "2020-09-23"
          },
          {
            "company": {
              "name": "logan ltd",
              "size": "10001+",
              "id": "HeZL3XKPSVdYtzOShakPQt1VxzfZ",
              "founded": 2004,
              "industry": "writing and editing",
              "location": {
                "name": "north davidborough, british columbia, canada",
                "locality": "north davidborough",
                "region": "british columbia",
                "metro": "north davidborough",
                "country": "canada",
                "continent": "north america",
                "street_address": "1510 james ferry",
                "address_line_2": "apt. 730",
                "postal_code": "A0A 8A6",
                "geo": "76.5910375,-125.507485"
              },
              "linkedin_url": "linkedin.com/company/logan-ltd",
              "linkedin_id": "34885857",
              "facebook_url": "facebook.com/logan-ltd",
              "twitter_url": "twitter.com/logan-ltd",
              "website": "logan-ltd.com",
              "ticker": null,
              "type": "public",
              "raw": [
                "logan ltd"
              ],
              "fuzzy_match": false
            },
            "location_names": [
              "williamsville, california, united states"
            ],
            "end_date": "2021-11-20",
            "start_date": "2019-09-22",
            "title": {
              "name": "environmental consultant",
              "raw": [
                "environmental consultant"
              ],
              "class": null,
              "role": null,
              "sub_role": null,
              "levels": [
                "partner",
                "senior"
              ]
            },
            "is_primary": false,
            "summary": "environmental consultant at logan ltd",
            "num_sources": 8,
            "first_seen": "2019-09-22",
            "last_seen": "2021-11-20"
          },
          {
            "company": {
              "name": "collins-owens",
              "size": "10001+",
              "id": "Sbqk9rHpzf9OhMg2wEcesQsKGTdx",
              "founded": 1970,
              "industry": "computer games",
              "location": {
                "name": "north richard, british columbia, canada",
                "locality": "north richard",
                "region": "british columbia",
                "metro": "north richard",
                "country": "canada",
                "continent": "north america",
                "street_address": "0300 james rest apt. 442",
                "address_line_2": "apt. 761",
                "postal_code": "A0A 4A7",
                "geo": "-58.920706,-42.298638"
              },
              "linkedin_url": "linkedin.com/company/collins-owens",
              "linkedin_id": "17907403",
              "facebook_url": "facebook.com/collins-owens",
              "twitter_url": "twitter.com/collins-owens",
              "website": "collins-owens.com",
              "ticker": null,
              "type": "nonprofit",
              "raw": [
                "collins-owens"
              ],
              "fuzzy_match": false
            },
            "location_names": [
              "angelastad, texas, united states"
            ],
            "end_date": "2019-07-30",
            "start_date": "2019-04-16",
            "title": {
              "name": "scientist, research (life sciences)",
              "raw": [
                "scientist, research (life sciences)"
              ],
              "class": null,
              "role": "research",
              "sub_role": null,
              "levels": [
                "cxo",
                "cxo"
              ]
            },
            "is_primary": false,
            "summary": "scientist, research (life sciences) at collins-owens",
            "num_sources": 8,
            "first_seen": "2019-04-16",
            "last_seen": "2019-07-30"
          }
        ],
        "education": [
          {
            "school": {
              "name": "lloyd, archer and patel",
              "type": "secondary school",
              "id": null,
              "location": {
                "name": "west corey, quebec, canada",
                "locality": "west corey",
                "region": "quebec",
                "country": "canada",
                "continent": "north america"
              },
              "linkedin_url": "linkedin.com/school/lloyd-archer-and-patel",
              "facebook_url": "facebook.com/lloyd-archer-and-patel",
              "twitter_url": "twitter.com/lloyd-archer-and-patel",
              "linkedin_id": "12518737",
              "website": "lloyd-archer-and-patel.edu",
              "domain": "lloyd-archer-and-patel.edu",
              "raw": [
                "lloyd, archer and patel"
              ]
            },
            "degrees": [
              "master of science in operations research"
            ],
            "start_date": "2000-10-21",
            "end_date": "2011-06-13",
            "majors": [
              "leadership",
              "graphic and printing science"
            ],
            "minors": [
              "korean languages",
              "behavioural science",
              "fashion"
            ],
            "gpa": 4.3,
            "raw": [
              "lloyd, archer and patel"
            ],
            "summary": "master of science in operations research majoring in leadership, graphic and printing science"
          },
          {
            "school": {
              "name": "nelson, thornton and watson",
              "type": "post-secondary institution",
              "id": null,
              "location": {
                "name": "cabreraville, new york, united states",
                "locality": "cabreraville",
                "region": "new york",
                "country": "united states",
                "continent": "north america"
              },
              "linkedin_url": "linkedin.com/school/nelson-thornton-and-watson",
              "facebook_url": "facebook.com/nelson-thornton-and-watson",
              "twitter_url": "twitter.com/nelson-thornton-and-watson",
              "linkedin_id": "15575449",
              "website": "nelson-thornton-and-watson.edu",
              "domain": "nelson-thornton-and-watson.edu",
              "raw": [
                "nelson, thornton and watson"
              ]
            },
            "degrees": [
              "master of science in materials engineering"
            ],
            "start_date": "2000-12-13",
            "end_date": "2005-11-02",
            "majors": [
              "computer systems"
            ],
            "minors": [
              "food preparation",
              "baltic studies"
            ],
            "gpa": 0.8,
            "raw": [
              "nelson, thornton and watson"
            ],
            "summary": "master of science in materials engineering majoring in computer systems"
          },
          {
            "school": {
              "name": "hale and sons",
              "type": "post-secondary institution",
              "id": null,
              "location": {
                "name": "grayshire, texas, united states",
                "locality": "grayshire",
                "region": "texas",
                "country": "united states",
                "continent": "north america"
              },
              "linkedin_url": "linkedin.com/school/hale-and-sons",
              "facebook_url": "facebook.com/hale-and-sons",
              "twitter_url": "twitter.com/hale-and-sons",
              "linkedin_id": "55718800",
              "website": "hale-and-sons.edu",
              "domain": "hale-and-sons.edu",
              "raw": [
                "hale and sons"
              ]
            },
            "degrees": [
              "master of science in civil engineering"
            ],
            "start_date": "2001-02-22",
            "end_date": "2012-10-27",
            "majors": [
              "performing arts"
            ],
            "minors": [
              "political science and government",
              "japanese language",
              "addiction counseling"
            ],
            "gpa": 1.0,
            "raw": [
              "hale and sons"
            ],
            "summary": "master of science in civil engineering majoring in performing arts"
          }
        ],
        "profiles": [
          {
            "network": "ello",
            "id": "iZpuCp",
            "url": "ello.com/sarah_r",
            "username": "sarah_r",
            "num_sources": 8,
            "first_seen": "2018-05-26",
            "last_seen": "2019-08-21"
          },
          {
            "network": "linkedin",
            "id": "NvnAvO",
            "url": "linkedin.com/in/sr49",
            "username": "sr49",
            "num_sources": 7,
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09"
          },
          {
            "network": "facebook",
            "id": "NvnAvO",
            "url": "facebook.com/sr49",
            "username": "sr49",
            "num_sources": 7,
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09"
          },
          {
            "network": "twitter",
            "id": "NvnAvO",
            "url": "twitter.com/sr49",
            "username": "sr49",
            "num_sources": 7,
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09"
          },
          {
            "network": "github",
            "id": "NvnAvO",
            "url": "github.com/sr49",
            "username": "sr49",
            "num_sources": 7,
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09"
          }
        ],
        "name_aliases": [
          "s.r"
        ],
        "possible_emails": [
          {
            "address": "mking@zoho.com",
            "type": "personal",
            "first_seen": "2025-03-01T05:43:08",
            "last_seen": "2025-03-04T17:34:09",
            "num_sources": 3
          },
          {
            "address": "valerie_morales@icloud.com",
            "type": "disposable",
            "first_seen": "2025-01-30T08:40:49",
            "last_seen": "2025-02-12T22:53:01",
            "num_sources": 1
          },
          {
            "address": "blake_m@me.com",
            "type": "personal",
            "first_seen": "2025-01-18T10:28:03",
            "last_seen": "2025-01-25T07:35:23",
            "num_sources": 1
          }
        ],
        "possible_profiles": [
          {
            "network": "gitlab",
            "id": "ktChZZ",
            "url": "gitlab.com/sarah_richard",
            "username": "sarah_richard",
            "num_sources": 3,
            "first_seen": "2019-01-25",
            "last_seen": "2021-04-20"
          }
        ],
        "possible_phones": [
          {
            "number": "+14313717138",
            "first_seen": "2019-07-25",
            "last_seen": "2019-06-06",
            "num_sources": 3
          }
        ],
        "possible_street_addresses": [],
        "possible_location_names": [],
        "possible_birth_dates": [
          "1988-06-06T00:00:00"
        ],
        "job_history": [
          {
            "company_id": "chang-fisher",
            "company_name": "chang-fisher",
            "title": "musician",
            "first_seen": "2019-11-24",
            "last_seen": "2021-09-09",
            "num_sources": 7
          },
          {
            "company_id": "williams-sheppard",
            "company_name": "williams-sheppard",
            "title": "sub",
            "first_seen": "2018-05-10",
            "last_seen": "2020-09-23",
            "num_sources": 1
          },
          {
            "company_id": "logan-ltd",
            "company_name": "logan ltd",
            "title": "environmental consultant",
            "first_seen": "2019-09-22",
            "last_seen": "2021-11-20",
            "num_sources": 8
          },
          {
            "company_id": "collins-owens",
            "company_name": "collins-owens",
            "title": "scientist, research (life sciences)",
            "first_seen": "2019-04-16",
            "last_seen": "2019-07-30",
            "num_sources": 8
          }
        ],
        "certifications": [
          {
            "organization": "sandoval inc",
            "start_date": "2012-03-21",
            "end_date": "2021-10-11",
            "name": "runner, broadcasting/film/video"
          },
          {
            "organization": "martin and sons",
            "start_date": "2013-01-26",
            "end_date": "2017-10-21",
            "name": "lecturer, higher education"
          },
          {
            "organization": "johnson-owens",
            "start_date": "2017-12-02",
            "end_date": "2011-06-13",
            "name": "chiropractor"
          }
        ],
        "languages": [
          {
            "name": "dinka",
            "proficiency": 1
          },
          {
            "name": "armenian",
            "proficiency": 5
          },
          {
            "name": "welsh",
            "proficiency": 2
          },
          {
            "name": "yakut",
            "proficiency": 3
          }
        ],
        "first_seen": "2021-04-11",
        "num_sources": 27,
        "num_records": 4,
        "dataset_version": "v25.2"
      }

    const currentJob = personData.experience?.find((exp: any) => exp.is_primary) || personData.experience?.[0];
    
    const transformedData = {
      company: {
        name: currentJob?.company?.name || personData.job_company_name || 'Unknown',
        employees: currentJob?.company?.size || personData.job_company_size || 'Unknown employees',
        founded: currentJob?.company?.founded || personData.job_company_founded || 'Unknown',
        description: `${currentJob?.company?.name || personData.job_company_name || 'Unknown'} is a ${currentJob?.company?.type || personData.job_company_type || ''} company in the ${currentJob?.company?.industry || personData.job_company_industry || 'Unknown'} industry.`,
      },
      metrics: {
        revenueRange: personData.job_company_inferred_revenue || 'Unknown',
        location: personData.job_company_location_name || currentJob?.company?.location?.name || 'Unknown',
        industry: personData.job_company_industry || currentJob?.company?.industry || 'Unknown',
        type: personData.job_company_type || currentJob?.company?.type || 'Unknown'
      },
      person: {
        name: `${personData.first_name} ${personData.last_name}`,
        position: personData.job_title || currentJob?.title?.name || 'Unknown position',
        location: personData.location_name || 'Unknown location',
        seniority: personData.job_title_levels?.[0] || currentJob?.title?.levels?.[0] || 'Unknown',
        headline: personData.summary || personData.headline || '',
        photo_url: personData?.profile_pic_url || null,
        employment_history: (personData.experience || []).map((exp: any) => ({
          organization: exp.company?.name || '',
          title: exp.title?.name || '',
          start_date: exp.start_date || '',
          end_date: exp.end_date || '',
          location: exp.company?.location?.name || exp.location_names?.[0] || '',
          description: exp.summary || ''
        }))
      }
    };

    return transformedData;
  } catch (error) {
    console.error('PDL Person Search Error:', error);
    throw error;
  }
}

async function getCompanyInfo(companyName: string) {
  try {
    // const params = new URLSearchParams({
    //   name: companyName,
    //   pretty: 'true',
    //   titlecase: 'true'
    // });

    // const response = await fetch(`${PDL_BASE_URL}/company/enrich?${params}`, {
    //   method: 'GET',
    //   headers: {
    //     'X-Api-Key': `${PDL_API_KEY}`
    //   }
    // });

    // if (!response.ok) {
    //   const errorData = await response.json();
    //   throw new Error(errorData.message || 'Failed to fetch company data');
    // }

    // const data = await response.json();
    const data={"data":{
        "name": "people data labs",
        "size": "11-50",
        "employee_count": 122,
        "id": "tnHcNHbCv8MKeLh92946LAkX6PKg",
        "founded": 2015,
        "inferred_revenue": "$25M-$50M",
        "industry": "computer software",
        "naics": null,
        "sic": null,
        "location": {
          "name": "san francisco, california, united states",
          "locality": "san francisco",
          "region": "california",
          "metro": "san francisco, california",
          "country": "united states",
          "continent": "north america",
          "street_address": "455 market street",
          "address_line_2": "suite 1670",
          "postal_code": "94105",
          "geo": "37.77,-122.41"
        },
        "linkedin_id": "18170482",
        "linkedin_follower_count": 6493,
        "linkedin_url": "linkedin.com/company/peopledatalabs",
        "linkedin_slug": "peopledatalabs",
        "facebook_url": "facebook.com/peopledatalabs",
        "twitter_url": "twitter.com/peopledatalabs",
        "profiles": [
          "linkedin.com/company/peopledatalabs",
          "linkedin.com/company/18170482",
          "facebook.com/peopledatalabs",
          "twitter.com/peopledatalabs",
          "crunchbase.com/organization/talentiq"
        ],
        "website": "peopledatalabs.com",
        "ticker": null,
        "mic_exchange": null,
        "type": "private",
        "summary": "people data labs builds people data. \n\nuse our dataset of 1.5 billion unique person profiles to build products, enrich person profiles, power predictive modeling/ai, analysis, and more. we work with technical teams as their engineering focused people data partner. \n\nwe work with thousands of data science teams as their engineering focused people data partner. these include enterprises like adidas, ebay, and acxiom, as well as startups like madison logic, zoho, and workable. we are a deeply technical company, and are backed by two leading engineering venture capital firms - founders fund and 8vc.",
        "tags": [
          "data",
          "people data",
          "data science",
          "artificial intelligence",
          "data and analytics",
          "machine learning",
          "analytics",
          "database",
          "software",
          "developer apis"
        ],
        "headline": "Your Single Source of Truth",
        "alternative_names": [],
        "alternative_domains": [],
        "affiliated_profiles": [],
        "total_funding_raised": 55250000.0,
        "latest_funding_stage": "series_b",
        "last_funding_date": "2021-11-16",
        "number_funding_rounds": 7,
        "funding_stages": [
          "series_b",
          "series_a",
          "seed"
        ],
        "ultimate_parent": null,
        "immediate_parent": null,
        "direct_subsidiaries": null,
        "all_subsidiaries": null,
        "employee_growth_rate_12_month_by_role": {
          "real_estate": 0.0,
          "design": 0.0234,
          "trades": 0.0,
          "marketing": 0.2,
          "education": 0.5421,
          "legal": 0.0,
          "customer_service": 1.3245,
          "finance": 1.0,
          "public_relations": 0.0,
          "engineering": 2.2341,
          "human_resources": 1.0435,
          "media": 0.2345,
          "sales": 0.0,
          "operations": 1.1231,
          "health": 0.0,
          "other_uncategorized": 0.0
        },
        "employee_growth_rate": {
          "3_month": 0.0522,
          "6_month": 0.0342,
          "12_month": 0.375,
          "24_month": 1.283
        },
        "employee_churn_rate": {
          "3_month": 0.0248,
          "6_month": 0.124,
          "12_month": 0.1983,
          "24_month": 0.3306
        },
        "average_employee_tenure": 1.626,
        "average_tenure_by_role": {
          "real_estate": 0.0,
          "design": 0.917,
          "trades": 0.0,
          "marketing": 1.476,
          "education": 4.833,
          "legal": 0.0,
          "customer_service": 1.141,
          "finance": 1.521,
          "public_relations": 0.0,
          "engineering": 1.827,
          "human_resources": 1.083,
          "media": 1.194,
          "sales": 0.798,
          "operations": 0.902,
          "health": 0.0
        },
        "average_tenure_by_level": {
          "entry": 0.0,
          "unpaid": 0.0,
          "senior": 1.076,
          "director": 1.975,
          "vp": 2.892,
          "training": 0.778,
          "manager": 1.056,
          "owner": 7.75,
          "partner": 0.0,
          "cxo": 4.486
        },
        "employee_count_by_country": {
          "united states": 108,
          "canada": 2,
          "india": 1
        },
        "employee_count_by_role": {
          "real_estate": 0,
          "design": 1,
          "trades": 0,
          "marketing": 2,
          "education": 1,
          "legal": 0,
          "customer_service": 1,
          "finance": 1,
          "public_relations": 0,
          "engineering": 26,
          "human_resources": 1,
          "media": 1,
          "sales": 2,
          "operations": 1,
          "health": 0,
          "other_uncategorized": 0
        },
        "top_us_employee_metros": {
          "san francisco, california, united states": {
            "current_headcount": 26,
            "12_month_growth_rate": 0.1818
          },
          "new york, new york, united states": {
            "current_headcount": 11,
            "12_month_growth_rate": 0.2222
          },
          "seattle, washington, united states": {
            "current_headcount": 9,
            "12_month_growth_rate": 1.25
          },
          "san diego, california, united states": {
            "current_headcount": 6,
            "12_month_growth_rate": 1.0
          },
          "portland, oregon, united states": {
            "current_headcount": 6,
            "12_month_growth_rate": -0.25
          },
          "los angeles, california, united states": {
            "current_headcount": 6,
            "12_month_growth_rate": 0.2
          },
          "spokane, washington, united states": {
            "current_headcount": 4,
            "12_month_growth_rate": 1.0
          },
          "district of columbia, united states": {
            "current_headcount": 4,
            "12_month_growth_rate": 1.0
          },
          "denver, colorado, united states": {
            "current_headcount": 4,
            "12_month_growth_rate": 1.0
          },
          "chicago, illinois, united states": {
            "current_headcount": 3,
            "12_month_growth_rate": 0.5
          }
        },
        "employee_count_by_month": {
          "2015-03": 3,
          "2015-04": 3,
          "2015-05": 3,
          "2015-06": 3,
          "2015-07": 4,
          "2015-08": 7,
          "2015-09": 8,
          "2015-10": 8,
          "2015-11": 8,
          "2015-12": 8,
          "2016-01": 8,
          "2016-02": 8,
          "2016-03": 8,
          "2016-04": 9,
          "2016-05": 9,
          "2016-06": 9,
          "2016-07": 10,
          "2016-08": 10,
          "2016-09": 10,
          "2016-10": 11,
          "2016-11": 11,
          "2016-12": 11,
          "2017-01": 13,
          "2017-02": 13,
          "2017-03": 13,
          "2017-04": 14,
          "2017-05": 16,
          "2017-06": 16,
          "2017-07": 16,
          "2017-08": 17,
          "2017-09": 17,
          "2017-10": 17,
          "2017-11": 18,
          "2017-12": 19,
          "2018-01": 21,
          "2018-02": 22,
          "2018-03": 22,
          "2018-04": 22,
          "2018-05": 23,
          "2018-06": 25,
          "2018-07": 27,
          "2018-08": 28,
          "2018-09": 28,
          "2018-10": 27,
          "2018-11": 31,
          "2018-12": 30,
          "2019-01": 35,
          "2019-02": 35,
          "2019-03": 37,
          "2019-04": 39,
          "2019-05": 39,
          "2019-06": 37,
          "2019-07": 37,
          "2019-08": 37,
          "2019-09": 37,
          "2019-10": 37,
          "2019-11": 38,
          "2019-12": 41,
          "2020-01": 43,
          "2020-02": 43,
          "2020-03": 43,
          "2020-04": 44,
          "2020-05": 44,
          "2020-06": 47,
          "2020-07": 48,
          "2020-08": 48,
          "2020-09": 48,
          "2020-10": 50,
          "2020-11": 51,
          "2020-12": 53,
          "2021-01": 58,
          "2021-02": 64,
          "2021-03": 70,
          "2021-04": 71,
          "2021-05": 75,
          "2021-06": 78,
          "2021-07": 80,
          "2021-08": 81,
          "2021-09": 81,
          "2021-10": 87,
          "2021-11": 88,
          "2021-12": 88,
          "2022-01": 90,
          "2022-02": 92,
          "2022-03": 100,
          "2022-04": 105,
          "2022-05": 112,
          "2022-06": 117,
          "2022-07": 116,
          "2022-08": 116,
          "2022-09": 115,
          "2022-10": 120,
          "2022-11": 121,
          "2022-12": 121
        },
        "gross_additions_by_month": {
          "2015-03": 3,
          "2015-04": 0,
          "2015-05": 0,
          "2015-06": 0,
          "2015-07": 1,
          "2015-08": 3,
          "2015-09": 1,
          "2015-10": 0,
          "2015-11": 0,
          "2015-12": 0,
          "2016-01": 0,
          "2016-02": 0,
          "2016-03": 0,
          "2016-04": 1,
          "2016-05": 0,
          "2016-06": 0,
          "2016-07": 1,
          "2016-08": 0,
          "2016-09": 0,
          "2016-10": 1,
          "2016-11": 0,
          "2016-12": 0,
          "2017-01": 0,
          "2017-02": 0,
          "2017-03": 0,
          "2017-04": 1,
          "2017-05": 2,
          "2017-06": 0,
          "2017-07": 0,
          "2017-08": 1,
          "2017-09": 1,
          "2017-10": 0,
          "2017-11": 1,
          "2017-12": 1,
          "2018-01": 1,
          "2018-02": 2,
          "2018-03": 0,
          "2018-04": 0,
          "2018-05": 1,
          "2018-06": 2,
          "2018-07": 2,
          "2018-08": 1,
          "2018-09": 1,
          "2018-10": 0,
          "2018-11": 4,
          "2018-12": 0,
          "2019-01": 6,
          "2019-02": 0,
          "2019-03": 2,
          "2019-04": 2,
          "2019-05": 0,
          "2019-06": 0,
          "2019-07": 1,
          "2019-08": 0,
          "2019-09": 0,
          "2019-10": 0,
          "2019-11": 1,
          "2019-12": 3,
          "2020-01": 2,
          "2020-02": 1,
          "2020-03": 1,
          "2020-04": 2,
          "2020-05": 0,
          "2020-06": 2,
          "2020-07": 3,
          "2020-08": 1,
          "2020-09": 1,
          "2020-10": 2,
          "2020-11": 2,
          "2020-12": 2,
          "2021-01": 8,
          "2021-02": 7,
          "2021-03": 6,
          "2021-04": 2,
          "2021-05": 4,
          "2021-06": 3,
          "2021-07": 5,
          "2021-08": 1,
          "2021-09": 0,
          "2021-10": 8,
          "2021-11": 4,
          "2021-12": 0,
          "2022-01": 2,
          "2022-02": 2,
          "2022-03": 9,
          "2022-04": 5,
          "2022-05": 7,
          "2022-06": 6,
          "2022-07": 1,
          "2022-08": 1,
          "2022-09": 1,
          "2022-10": 7,
          "2022-11": 1,
          "2022-12": 0
        },
        "gross_departures_by_month": {
          "2017-08": 1,
          "2017-09": 0,
          "2017-10": 0,
          "2017-11": 0,
          "2017-12": 0,
          "2018-01": 0,
          "2018-02": 0,
          "2018-03": 0,
          "2018-04": 0,
          "2018-05": 0,
          "2018-06": 0,
          "2018-07": 0,
          "2018-08": 2,
          "2018-09": 1,
          "2018-10": 0,
          "2018-11": 1,
          "2018-12": 1,
          "2019-01": 0,
          "2019-02": 0,
          "2019-03": 0,
          "2019-04": 0,
          "2019-05": 2,
          "2019-06": 1,
          "2019-07": 0,
          "2019-08": 0,
          "2019-09": 0,
          "2019-10": 0,
          "2019-11": 0,
          "2019-12": 0,
          "2020-01": 1,
          "2020-02": 0,
          "2020-03": 1,
          "2020-04": 0,
          "2020-05": 0,
          "2020-06": 2,
          "2020-07": 1,
          "2020-08": 1,
          "2020-09": 0,
          "2020-10": 1,
          "2020-11": 0,
          "2020-12": 1,
          "2021-01": 1,
          "2021-02": 0,
          "2021-03": 1,
          "2021-04": 0,
          "2021-05": 0,
          "2021-06": 2,
          "2021-07": 0,
          "2021-08": 0,
          "2021-09": 1,
          "2021-10": 3,
          "2021-11": 0,
          "2021-12": 0,
          "2022-01": 0,
          "2022-02": 1,
          "2022-03": 0,
          "2022-04": 0,
          "2022-05": 1,
          "2022-06": 2,
          "2022-07": 1,
          "2022-08": 2,
          "2022-09": 2,
          "2022-10": 0,
          "2022-11": 0,
          "2022-12": 0
        },
        "employee_count_by_month_by_role": {
          "2015-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2015-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2015-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2015-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2015-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2015-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 1,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2015-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2015-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2015-11": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2015-12": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-01": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-02": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 0,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2016-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 0,
            "health": 0
          },
          "2016-11": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 0,
            "health": 0
          },
          "2016-12": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 2,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 0,
            "health": 0
          },
          "2017-01": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 0,
            "health": 0
          },
          "2017-02": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 1,
            "health": 0
          },
          "2017-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2017-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 2,
            "operations": 2,
            "health": 0
          },
          "2017-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 2,
            "health": 0
          },
          "2017-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 2,
            "health": 0
          },
          "2017-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 4,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 2,
            "health": 0
          },
          "2017-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 5,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 2,
            "health": 0
          },
          "2017-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 5,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2017-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 6,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2017-11": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 7,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2017-12": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 8,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2018-01": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 0,
            "education": 0,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2018-02": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2018-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2018-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2018-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 11,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2018-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 1,
            "public_relations": 0,
            "engineering": 12,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2018-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 12,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2018-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 12,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2018-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 12,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2018-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2018-11": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 11,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 0,
            "health": 0
          },
          "2018-12": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 10,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-01": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-02": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 5,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 6,
            "education": 1,
            "legal": 0,
            "customer_service": 0,
            "finance": 2,
            "public_relations": 0,
            "engineering": 17,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 6,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 0,
            "health": 0
          },
          "2019-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 5,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2019-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2019-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2019-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2019-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 0,
            "operations": 1,
            "health": 0
          },
          "2019-11": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 1,
            "health": 0
          },
          "2019-12": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 0,
            "media": 0,
            "sales": 1,
            "operations": 3,
            "health": 0
          },
          "2020-01": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 4,
            "education": 1,
            "legal": 0,
            "customer_service": 2,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 0,
            "media": 0,
            "sales": 3,
            "operations": 4,
            "health": 0
          },
          "2020-02": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 2,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 1,
            "media": 0,
            "sales": 4,
            "operations": 4,
            "health": 0
          },
          "2020-03": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 2,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 1,
            "media": 0,
            "sales": 5,
            "operations": 5,
            "health": 0
          },
          "2020-04": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 1,
            "media": 0,
            "sales": 6,
            "operations": 5,
            "health": 0
          },
          "2020-05": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 1,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 1,
            "media": 0,
            "sales": 7,
            "operations": 5,
            "health": 0
          },
          "2020-06": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 2,
            "finance": 3,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 1,
            "media": 0,
            "sales": 7,
            "operations": 4,
            "health": 0
          },
          "2020-07": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 2,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 1,
            "media": 0,
            "sales": 9,
            "operations": 4,
            "health": 0
          },
          "2020-08": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 3,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 1,
            "media": 0,
            "sales": 9,
            "operations": 4,
            "health": 0
          },
          "2020-09": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 3,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 1,
            "media": 0,
            "sales": 10,
            "operations": 4,
            "health": 0
          },
          "2020-10": {
            "real_estate": 0,
            "design": 0,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 3,
            "finance": 2,
            "public_relations": 0,
            "engineering": 16,
            "human_resources": 2,
            "media": 0,
            "sales": 10,
            "operations": 5,
            "health": 0
          },
          "2020-11": {
            "real_estate": 0,
            "design": 1,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 3,
            "finance": 2,
            "public_relations": 0,
            "engineering": 17,
            "human_resources": 2,
            "media": 0,
            "sales": 9,
            "operations": 5,
            "health": 0
          },
          "2020-12": {
            "real_estate": 0,
            "design": 1,
            "trades": 0,
            "marketing": 1,
            "education": 1,
            "legal": 0,
            "customer_service": 3,
            "finance": 2,
            "public_relations": 0,
            "engineering": 17,
            "human_resources": 2,
            "media": 0,
            "sales": 10,
            "operations": 6,
            "health": 0
          },
          "2021-01": {
            "real_estate": 0,
            "design": 1,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 4,
            "finance": 2,
            "public_relations": 0,
            "engineering": 15,
            "human_resources": 2,
            "media": 0,
            "sales": 12,
            "operations": 7,
            "health": 0
          },
          "2021-02": {
            "real_estate": 0,
            "design": 1,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 4,
            "finance": 2,
            "public_relations": 0,
            "engineering": 18,
            "human_resources": 2,
            "media": 1,
            "sales": 13,
            "operations": 7,
            "health": 0
          },
          "2021-03": {
            "real_estate": 0,
            "design": 1,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 8,
            "finance": 2,
            "public_relations": 0,
            "engineering": 20,
            "human_resources": 2,
            "media": 1,
            "sales": 13,
            "operations": 7,
            "health": 0
          },
          "2021-04": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 8,
            "finance": 2,
            "public_relations": 0,
            "engineering": 20,
            "human_resources": 2,
            "media": 1,
            "sales": 12,
            "operations": 7,
            "health": 0
          },
          "2021-05": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 8,
            "finance": 2,
            "public_relations": 0,
            "engineering": 21,
            "human_resources": 2,
            "media": 1,
            "sales": 12,
            "operations": 8,
            "health": 0
          },
          "2021-06": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 2,
            "public_relations": 0,
            "engineering": 23,
            "human_resources": 2,
            "media": 1,
            "sales": 13,
            "operations": 8,
            "health": 0
          },
          "2021-07": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 23,
            "human_resources": 2,
            "media": 2,
            "sales": 15,
            "operations": 8,
            "health": 0
          },
          "2021-08": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 23,
            "human_resources": 2,
            "media": 2,
            "sales": 16,
            "operations": 8,
            "health": 0
          },
          "2021-09": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 23,
            "human_resources": 2,
            "media": 2,
            "sales": 16,
            "operations": 8,
            "health": 0
          },
          "2021-10": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 27,
            "human_resources": 2,
            "media": 2,
            "sales": 18,
            "operations": 9,
            "health": 0
          },
          "2021-11": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 29,
            "human_resources": 3,
            "media": 2,
            "sales": 16,
            "operations": 9,
            "health": 0
          },
          "2021-12": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 9,
            "finance": 1,
            "public_relations": 0,
            "engineering": 29,
            "human_resources": 3,
            "media": 2,
            "sales": 16,
            "operations": 9,
            "health": 0
          },
          "2022-01": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 10,
            "finance": 1,
            "public_relations": 0,
            "engineering": 32,
            "human_resources": 3,
            "media": 2,
            "sales": 14,
            "operations": 9,
            "health": 0
          },
          "2022-02": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 10,
            "finance": 1,
            "public_relations": 0,
            "engineering": 32,
            "human_resources": 3,
            "media": 2,
            "sales": 15,
            "operations": 8,
            "health": 0
          },
          "2022-03": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 13,
            "finance": 1,
            "public_relations": 0,
            "engineering": 33,
            "human_resources": 4,
            "media": 2,
            "sales": 16,
            "operations": 8,
            "health": 0
          },
          "2022-04": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 13,
            "finance": 1,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 4,
            "media": 3,
            "sales": 16,
            "operations": 9,
            "health": 0
          },
          "2022-05": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 2,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 5,
            "media": 3,
            "sales": 17,
            "operations": 11,
            "health": 0
          },
          "2022-06": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 5,
            "media": 3,
            "sales": 20,
            "operations": 12,
            "health": 0
          },
          "2022-07": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 5,
            "media": 3,
            "sales": 19,
            "operations": 11,
            "health": 0
          },
          "2022-08": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 5,
            "media": 3,
            "sales": 20,
            "operations": 11,
            "health": 0
          },
          "2022-09": {
            "real_estate": 0,
            "design": 2,
            "trades": 0,
            "marketing": 3,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 35,
            "human_resources": 5,
            "media": 2,
            "sales": 19,
            "operations": 11,
            "health": 0
          },
          "2022-10": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 39,
            "human_resources": 5,
            "media": 2,
            "sales": 19,
            "operations": 12,
            "health": 0
          },
          "2022-11": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 39,
            "human_resources": 5,
            "media": 2,
            "sales": 20,
            "operations": 12,
            "health": 0
          },
          "2022-12": {
            "real_estate": 0,
            "design": 3,
            "trades": 0,
            "marketing": 2,
            "education": 1,
            "legal": 0,
            "customer_service": 14,
            "finance": 3,
            "public_relations": 0,
            "engineering": 39,
            "human_resources": 5,
            "media": 2,
            "sales": 20,
            "operations": 12,
            "health": 0
          }
        },
        "employee_count_by_month_by_level": {
          "2015-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 0,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 0,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 0,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 0,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 0,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2015-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 0,
            "director": 0,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2016-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 1,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 1,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 2,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 2,
            "vp": 3,
            "training": 0,
            "manager": 0,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 2,
            "vp": 3,
            "training": 0,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2017-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 3,
            "vp": 3,
            "training": 0,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 2,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 3,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 3,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 3,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 3,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 3
          },
          "2018-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 2,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2018-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 4,
            "vp": 3,
            "training": 2,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2018-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 4,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 6,
            "vp": 3,
            "training": 1,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 6,
            "vp": 3,
            "training": 1,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 7,
            "vp": 3,
            "training": 1,
            "manager": 2,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 7,
            "vp": 3,
            "training": 1,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 7,
            "vp": 3,
            "training": 1,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 7,
            "vp": 3,
            "training": 1,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 7,
            "vp": 3,
            "training": 0,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 3,
            "director": 8,
            "vp": 3,
            "training": 0,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2019-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 5,
            "director": 11,
            "vp": 3,
            "training": 0,
            "manager": 1,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 14,
            "vp": 3,
            "training": 0,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 4,
            "director": 15,
            "vp": 3,
            "training": 0,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 5,
            "director": 14,
            "vp": 3,
            "training": 0,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 5,
            "director": 14,
            "vp": 3,
            "training": 0,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 5
          },
          "2020-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 5,
            "director": 14,
            "vp": 3,
            "training": 0,
            "manager": 3,
            "owner": 3,
            "partner": 0,
            "cxo": 5
          },
          "2020-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 6,
            "director": 13,
            "vp": 3,
            "training": 0,
            "manager": 5,
            "owner": 3,
            "partner": 0,
            "cxo": 5
          },
          "2020-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 6,
            "director": 14,
            "vp": 3,
            "training": 0,
            "manager": 7,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 6,
            "director": 13,
            "vp": 3,
            "training": 0,
            "manager": 9,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 7,
            "director": 12,
            "vp": 3,
            "training": 0,
            "manager": 9,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 7,
            "director": 12,
            "vp": 3,
            "training": 0,
            "manager": 10,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 9,
            "director": 12,
            "vp": 3,
            "training": 0,
            "manager": 10,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2020-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 9,
            "director": 14,
            "vp": 4,
            "training": 0,
            "manager": 10,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 9,
            "director": 17,
            "vp": 5,
            "training": 0,
            "manager": 11,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 10,
            "director": 17,
            "vp": 5,
            "training": 0,
            "manager": 15,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 12,
            "director": 17,
            "vp": 5,
            "training": 0,
            "manager": 18,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 12,
            "director": 16,
            "vp": 5,
            "training": 0,
            "manager": 19,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 14,
            "director": 17,
            "vp": 5,
            "training": 0,
            "manager": 21,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 16,
            "director": 20,
            "vp": 5,
            "training": 0,
            "manager": 21,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 14,
            "director": 20,
            "vp": 6,
            "training": 0,
            "manager": 17,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 12,
            "director": 20,
            "vp": 6,
            "training": 0,
            "manager": 20,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 10,
            "director": 20,
            "vp": 6,
            "training": 0,
            "manager": 18,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 14,
            "director": 20,
            "vp": 6,
            "training": 0,
            "manager": 18,
            "owner": 3,
            "partner": 0,
            "cxo": 4
          },
          "2021-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 14,
            "director": 19,
            "vp": 7,
            "training": 0,
            "manager": 18,
            "owner": 3,
            "partner": 0,
            "cxo": 5
          },
          "2021-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 14,
            "director": 18,
            "vp": 7,
            "training": 0,
            "manager": 18,
            "owner": 3,
            "partner": 0,
            "cxo": 5
          },
          "2022-01": {
            "entry": 0,
            "unpaid": 0,
            "senior": 15,
            "director": 17,
            "vp": 7,
            "training": 0,
            "manager": 20,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-02": {
            "entry": 0,
            "unpaid": 0,
            "senior": 15,
            "director": 17,
            "vp": 7,
            "training": 0,
            "manager": 22,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-03": {
            "entry": 0,
            "unpaid": 0,
            "senior": 16,
            "director": 17,
            "vp": 8,
            "training": 0,
            "manager": 23,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-04": {
            "entry": 0,
            "unpaid": 0,
            "senior": 17,
            "director": 17,
            "vp": 8,
            "training": 0,
            "manager": 24,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-05": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 28,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-06": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 19,
            "vp": 8,
            "training": 0,
            "manager": 27,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-07": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 28,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-08": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 27,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-09": {
            "entry": 0,
            "unpaid": 0,
            "senior": 20,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 24,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-10": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 26,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-11": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 27,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          },
          "2022-12": {
            "entry": 0,
            "unpaid": 0,
            "senior": 21,
            "director": 18,
            "vp": 8,
            "training": 0,
            "manager": 27,
            "owner": 3,
            "partner": 0,
            "cxo": 6
          }
        },
        "recent_exec_hires": [
          {
            "joined_date": "2022-11",
            "pdl_id": "CDyZmCMZfVBnQgmn-peGYw_0000",
            "job_title": "vice president of revenue",
            "job_title_role": "sales",
            "job_title_sub_role": "business_development",
            "job_title_levels": [
              "vp"
            ],
            "previous_company_id": "veraset",
            "previous_company_job_title": "director of partnerships, data strategist",
            "previous_company_job_title_role": "operations",
            "previous_company_job_title_sub_role": null,
            "previous_company_job_title_levels": [
              "director"
            ]
          },
          {
            "joined_date": "2022-10",
            "pdl_id": "BoIx3hifL9UkyX5IziKWNA_0000",
            "job_title": "vice president, customer success",
            "job_title_role": "customer_service",
            "job_title_sub_role": "customer_success",
            "job_title_levels": [
              "vp"
            ],
            "previous_company_id": "talkdesk",
            "previous_company_job_title": "director, customer success na",
            "previous_company_job_title_role": "customer_service",
            "previous_company_job_title_sub_role": "customer_success",
            "previous_company_job_title_levels": [
              "director"
            ]
          }
        ],
        "recent_exec_departures": [
          {
            "departed_date": "2022-11",
            "pdl_id": "CDyZmCMZfVBnQgmn-peGYw_0000",
            "job_title": "vice president of sales",
            "job_title_role": "sales",
            "job_title_sub_role": "accounts",
            "job_title_levels": [
              "vp"
            ],
            "new_company_id": null,
            "new_company_job_title": null,
            "new_company_job_title_role": null,
            "new_company_job_title_sub_role": null,
            "new_company_job_title_levels": []
          },
          {
            "departed_date": "2022-09",
            "pdl_id": "F6SBEuktYttR-bi7JNBuSA_0000",
            "job_title": "vice president of customer success",
            "job_title_role": "customer_service",
            "job_title_sub_role": "customer_success",
            "job_title_levels": [
              "vp"
            ],
            "new_company_id": "fossa",
            "new_company_job_title": "vice president of customer success",
            "new_company_job_title_role": "customer_service",
            "new_company_job_title_sub_role": "customer_success",
            "new_company_job_title_levels": [
              "vp"
            ]
          }
        ],
        "top_previous_employers_by_role": {
          "all": {
            "pipl-inc": 8,
            "oracle": 7,
            "intel-corporation": 5,
            "best-buy": 5,
            "goodtime.io": 4,
            "outreach-saas": 3,
            "dun-&-bradstreet": 3,
            "urban-robotics-inc.": 3,
            "arrow-electronics": 2,
            "hubspot": 2
          },
          "sales": {
            "pipl-inc": 4,
            "dun-&-bradstreet": 2,
            "act-on-software": 2,
            "goodtime.io": 2,
            "memoryblue": 2,
            "carta--": 2,
            "loyola-marymount-university": 2,
            "lukins-&-annis-p-s-": 1,
            "university-of-portland": 1,
            "thomas-hammer-coffee-roasters": 1
          },
          "engineering": {
            "best-buy": 4,
            "oracle": 3,
            "urban-robotics-inc.": 3,
            "intel-corporation": 2,
            "microsoft": 2,
            "wsi-watershed-sciences-inc": 2,
            "quantum-spatial": 2,
            "aelius-exploitation-technologies-llc": 2,
            "us-army": 2,
            "dark-horse-comics": 2
          },
          "marketing": {
            "oklahoma-city-university": 1,
            "nova-home-loans": 1,
            "walt-disney-world": 1,
            "usfproductiongroup": 1,
            "parksite": 1,
            "fifty-&-five-llc": 1,
            "mit-sloan-school-of-management": 1,
            "microsoft": 1,
            "local-market-pdx": 1,
            "discoverorg": 1
          },
          "human_resources": {
            "seattle-university": 1,
            "university-of-san-francisco": 1,
            "bizible": 1,
            "the-walt-disney-company": 1,
            "arivale": 1,
            "outreach-saas": 1,
            "98point6-inc.": 1,
            "moxtra": 1,
            "gentlebirth": 1,
            "voiceops": 1
          },
          "finance": {
            "berkeley-investment-group": 1,
            "morgan-stanley": 1,
            "coatue-management": 1,
            "vfaseattle": 1,
            "virgin-america": 1,
            "popsugar": 1,
            "conversica": 1,
            "west-valley-college": 1,
            "loyola-marymount-university": 1,
            "london-alley-entertainment": 1
          },
          "customer_service": {
            "pipl-inc": 2,
            "thomson-reuters": 2,
            "diligent-board-member-services": 2,
            "town-of-prescott-valley-arizona": 1,
            "ewu": 1,
            "anomalix": 1,
            "fts-international": 1,
            "hexion-inc": 1,
            "hilti-usa": 1,
            "international-justice-mission": 1
          },
          "design": {
            "agence-monolith": 1,
            "square-tomato": 1,
            "navazon-consulting": 1,
            "oim-squared": 1,
            "chimney": 1,
            "thunder-industries": 1,
            "purdue-university": 1,
            "temple-university": 1,
            "philadelphia-society-for-the-preservation-of-landmarks": 1,
            "pennsylvania-horticultural-society": 1
          },
          "operations": {
            "wsi-watershed-sciences-inc": 2,
            "urban-robotics-inc.": 2,
            "quantum-spatial": 2,
            "aelius-exploitation-technologies-llc": 2,
            "enterprise-rent-a-car": 1,
            "allergan": 1,
            "powderhouse-productions": 1,
            "groupon": 1,
            "liftopia-inc.": 1,
            "stardustgravity": 1
          },
          "media": {
            "cengage-learning": 1,
            "university-of-california-irvine": 1,
            "kaiser-permanente": 1,
            "boy-scouts-of-america": 1,
            "dick's-sporting-goods": 1,
            "vanderbilt-university": 1,
            "bath-&-body-works": 1,
            "chago's-cantina": 1,
            "leftfield-pictures": 1,
            "hummingbird-productions": 1
          },
          "education": {}
        },
        "top_next_employers_by_role": {
          "all": {
            "exactbuyer": 2,
            "revenue-collective": 2,
            "assemblyai": 1,
            "the-mathworks_2": 1,
            "bae-systems": 1,
            "zynstra": 1,
            "university-of-massachusetts-amherst": 1,
            "green-street": 1,
            "berkeley-investment-group": 1,
            "snaplogic": 1
          },
          "sales": {
            "assemblyai": 1,
            "exactbuyer": 1,
            "snaplogic": 1,
            "fishtown-analytics": 1,
            "sisense": 1,
            "periscopedata": 1,
            "kappa-alpha-theta-foundation": 1,
            "lattice-semiconductor": 1,
            "first-round-fast-track": 1,
            "sutterhillventures": 1
          },
          "engineering": {
            "the-mathworks_2": 1,
            "bae-systems": 1,
            "zynstra": 1,
            "shipt": 1,
            "exactbuyer": 1,
            "gorgias": 1,
            "redviolet": 1,
            "samsung-electronics": 1,
            "picnichealth": 1,
            "omnivector": 1
          },
          "marketing": {
            "university-of-massachusetts-amherst": 1,
            "berkeley-investment-group": 1,
            "exactbuyer": 1,
            "gorgias": 1,
            "los-angeles-county-district-attorney-s-office": 1,
            "thai-community-development-ctr": 1,
            "orangecountyda": 1,
            "associated-students-of-the-university-of-california": 1,
            "venice-community-housing-corporation": 1,
            "amazon-web-services": 1
          },
          "human_resources": {
            "okta-inc-": 1
          },
          "finance": {
            "green-street": 1
          },
          "customer_service": {
            "fossa": 1,
            "revenue-collective": 1,
            "vette-io": 1
          },
          "design": {
            "lotame": 1
          },
          "operations": {
            "fishtown-analytics": 1,
            "sisense": 1,
            "periscopedata": 1,
            "picnichealth": 1
          },
          "media": {
            "versapay": 1
          },
          "education": {}
        }
      }}

    return data;
  } catch (error) {
    console.error('PDL Company Search Error:', error);
    throw error;
  }
}

export async function POST(request: Request) {
  try {
    if (!PDL_API_KEY) {
      return NextResponse.json(
        { error: 'PDL API key is not configured' },
        { status: 500 }
      );
    }

    const body = await request.json();
    const { linkedinUrl, companyDomain } = body;

    // Validate input
    if (!linkedinUrl) {
      return NextResponse.json(
        { error: 'LinkedIn URL is required' },
        { status: 400 }
      );
    }

    // Fetch person data from PDL
    const personData = await searchPerson(linkedinUrl);
    
    if (!personData) {
      return NextResponse.json(
        { error: 'No data found for the provided LinkedIn URL' },
        { status: 404 }
      );
    }

    // Get company data if available
    let companyData = null;
    if (personData.company.name) {
      companyData = await getCompanyInfo(personData.company.name);
    }

    return NextResponse.json({
      success: true,
      message: 'Data retrieved successfully',
      data: {
        company: companyData?.data ? {
          name: companyData.data.name,
          employees: companyData.data.size ? 
            `${companyData.data.size}` : 'Unknown employees',
          founded: companyData.data.founded || 'Unknown',
          description: companyData.data.summary || `${companyData.data.name} is a company based in ${companyData.data.location?.name || 'Unknown'}.`,
        } : {
          name: personData.company.name || 'Unknown',
          employees: personData.company.employees || 'Unknown employees',
          founded: personData.company.founded || 'Unknown',
          description: personData.company.description || `${personData.company.name || 'Unknown'} company.`
        },
        metrics: companyData?.data ? {
          revenueRange: companyData.data.inferred_revenue || 'Unknown',
          location: companyData.data.location?.name || 'Unknown',
          industry: companyData.data.industry || 'Unknown',
          type: companyData.data.type || 'Unknown'
        } : {
          revenueRange: 'Unknown',
          location: personData.metrics.location || 'Unknown',
          industry: personData.metrics.industry || 'Unknown',
          type: personData.metrics.type || 'Unknown'
        },
        person: {
          name: personData.person.name,
          position: personData.person.position || 'Unknown position',
          location: personData.person.location || 'Unknown location',
          seniority: personData.person.seniority || 'Unknown',
          headline: personData.person.headline || '',
          photo_url: personData.person.photo_url || null,
          employment_history: personData.person.employment_history || []
        }
      }
    });

  } catch (error) {
    console.error('API Error:', error);
    return NextResponse.json(
      { 
        success: false,
        message: 'An error occurred while processing your request',
        error: error instanceof Error ? error.message : 'Unknown error'
      },
      { status: 500 }
    );
  }
}
